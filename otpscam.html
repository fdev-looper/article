<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP Scam Security Training</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .simulation-container {
            width: 100%;
            max-width: 420px;
            height: 90vh;
            max-height: 750px;
            background: #000;
            border-radius: 40px;
            box-shadow: 
                0 0 0 8px #1a1a1a,
                0 0 0 12px #333,
                0 20px 60px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }

        .phone-frame {
            width: 100%;
            height: 100%;
            background: #000;
            border-radius: 32px;
            padding: 8px;
            position: relative;
        }

        .screen {
            width: 100%;
            height: 100%;
            background: #000;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
        }

        .dynamic-island {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 28px;
            background: #000;
            border-radius: 16px;
            z-index: 1000;
        }

        .status-bar {
            height: 44px;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            position: relative;
        }

        .stage {
            width: 100%;
            height: calc(100% - 44px);
            display: none;
            flex-direction: column;
            position: relative;
        }

        .stage.active {
            display: flex;
        }

        /* Welcome Screen */
        .welcome-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
            text-align: center;
        }

        .welcome-icon {
            width: 80px;
            height: 80px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin-bottom: 24px;
            backdrop-filter: blur(10px);
        }

        .welcome-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 16px;
            letter-spacing: -0.5px;
        }

        .welcome-subtitle {
            font-size: 16px;
            opacity: 0.9;
            line-height: 1.5;
            margin-bottom: 32px;
        }

        .start-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .start-button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Call Screen */
        .call-screen {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            flex: 1;
            position: relative;
        }

        .incoming-call-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 40px 30px 30px;
            z-index: 10;
        }

        .caller-info {
            text-align: center;
            color: white;
        }

        .caller-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 20px;
            animation: pulse 2s infinite;
            box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.7);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.7);
            }
            70% {
                transform: scale(1.05);
                box-shadow: 0 0 0 20px rgba(72, 187, 120, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(72, 187, 120, 0);
            }
        }

        .caller-name {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .caller-details {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 8px;
        }

        .call-status {
            font-size: 14px;
            color: #48bb78;
            margin-bottom: 20px;
        }

        .call-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 40px;
        }

        .call-button {
            width: 64px;
            height: 64px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.2s ease;
        }

        .decline-btn {
            background: #e53e3e;
            color: white;
        }

        .accept-btn {
            background: #48bb78;
            color: white;
        }

        .call-button:hover {
            transform: scale(1.1);
        }

        .call-button:active {
            transform: scale(0.95);
        }

        /* Active Call */
        .active-call {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .call-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .caller-mini {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mini-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .call-timer {
            font-size: 16px;
            color: #48bb78;
            font-weight: 600;
        }

        .conversation {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }

        .message {
            background: rgba(255,255,255,0.1);
            margin: 12px 0;
            padding: 16px;
            border-radius: 12px;
            border-left: 4px solid #e53e3e;
            font-size: 15px;
            line-height: 1.4;
            opacity: 0;
            transform: translateY(10px);
            animation: slideIn 0.5s ease forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 16px;
            margin: 8px 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: scale(1); }
            30% { transform: scale(1.3); }
        }

        .audio-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            margin: 10px 0;
        }

        .audio-bar {
            width: 3px;
            background: #48bb78;
            border-radius: 2px;
            animation: audioWave 1.2s ease-in-out infinite;
        }

        .audio-bar:nth-child(1) { height: 16px; animation-delay: 0s; }
        .audio-bar:nth-child(2) { height: 24px; animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { height: 20px; animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { height: 28px; animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { height: 18px; animation-delay: 0.4s; }

        @keyframes audioWave {
            0%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.3); }
        }

        .end-call-btn {
            background: #e53e3e;
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.2s ease;
        }

        .end-call-btn:hover {
            background: #c53030;
        }

        /* Decision Screen */
        .decision-screen {
            background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);
            color: white;
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
        }

        .decision-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .decision-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .decision-text {
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 24px;
            opacity: 0.95;
        }

        .decision-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .decision-btn {
            padding: 16px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .share-btn {
            background: #e53e3e;
            color: white;
        }

        .refuse-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .decision-btn:hover {
            transform: translateY(-2px);
        }

        /* Result Screen */
        .result-screen {
            padding: 30px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            color: white;
        }

        .result-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 16px;
        }

        .result-text {
            font-size: 15px;
            line-height: 1.5;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        .scammed-screen {
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
        }

        .safe-screen {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }

        .restart-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .restart-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Hidden audio elements */
        .audio-controls {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .simulation-container {
                max-width: 350px;
                height: 80vh;
            }
            
            .welcome-title {
                font-size: 20px;
            }
            
            .caller-name {
                font-size: 18px;
            }
        }

        @media (max-height: 600px) {
            .simulation-container {
                height: 95vh;
            }
            
            .welcome-screen,
            .decision-screen,
            .result-screen {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="simulation-container">
        <div class="phone-frame">
            <div class="dynamic-island"></div>
            <div class="screen">
                <div class="status-bar">
                    <span>Airtel 5G</span>
                    <span id="currentTime">14:23</span>
                    <span>82%</span>
                </div>

                <!-- Welcome Stage -->
                <div class="stage active" id="welcomeStage">
                    <div class="welcome-screen">
                        <div class="welcome-icon">🛡️</div>
                        <h1 class="welcome-title">Security Training</h1>
                        <p class="welcome-subtitle">Learn how to identify and avoid OTP scams through this interactive experience</p>
                        <button class="start-button" onclick="startSimulation()">Begin Training</button>
                    </div>
                </div>

                <!-- Incoming Call Stage -->
                <div class="stage" id="callStage">
                    <div class="call-screen">
                        <div class="incoming-call-overlay" id="incomingCall">
                            <div class="caller-info">
                                <div class="caller-avatar">🏦</div>
                                <div class="caller-name">State Bank of India</div>
                                <div class="caller-details">Security Department</div>
                                <div class="caller-details">+91-1800-425-3800</div>
                                <div class="call-status">Incoming call...</div>
                                
                                <audio id="ringtone" loop preload="auto">
                                    <source src="data:audio/mpeg;base64,//tAxAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAAIAAAOAACAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAAAAA" type="audio/mpeg">
                                </audio>
                            </div>
                            
                            <div class="call-actions">
                                <button class="call-button decline-btn" onclick="declineCall()">✕</button>
                                <button class="call-button accept-btn" onclick="acceptCall()">📞</button>
                            </div>
                        </div>

                        <!-- Active Call -->
                        <div class="active-call" id="activeCall" style="display: none;">
                            <div class="call-header">
                                <div class="caller-mini">
                                    <div class="mini-avatar">🏦</div>
                                    <div>
                                        <div style="font-size: 14px; font-weight: 600;">SBI Security</div>
                                        <div style="font-size: 12px; opacity: 0.7;">+91-1800-425-3800</div>
                                    </div>
                                </div>
                                <div class="call-timer" id="callTimer">00:00</div>
                            </div>
                            
                            <div class="conversation" id="conversation">
                                <!-- Messages will be added here dynamically -->
                            </div>
                            
                            <button class="end-call-btn" onclick="endCall()">End Call</button>
                        </div>
                    </div>
                </div>

                <!-- Decision Stage -->
                <div class="stage" id="decisionStage">
                    <div class="decision-screen">
                        <div class="decision-icon">⚠️</div>
                        <h2 class="decision-title">Critical Decision Point</h2>
                        <p class="decision-text">The caller is requesting your OTP code for "account verification." They claim your account will be blocked if you don't provide it immediately.</p>
                        <div class="decision-buttons">
                            <button class="decision-btn share-btn" onclick="shareOTP()">Share OTP Code</button>
                            <button class="decision-btn refuse-btn" onclick="refuseOTP()">Refuse & Hang Up</button>
                        </div>
                    </div>
                </div>

                <!-- Result Stage -->
                <div class="stage" id="resultStage">
                    <div class="result-screen" id="resultContent">
                        <!-- Content will be added dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Controls -->
    <div class="audio-controls">
        <audio id="audioElement" controls></audio>
    </div>

    <script>
        let currentStage = 'welcome';
        let callDuration = 0;
        let callTimer;
        let messageIndex = 0;
        let audioContext;
        let isAudioEnabled = false;

        const scammerMessages = [
            "Hello! Am I speaking with Mr. Rebel? This is Rajesh Kumar from State Bank of India Security Department.",
            "Sir, we have detected suspicious transactions on your account worth ₹25,000. Someone is trying to access your account.",
            "For your immediate security, we need to verify your identity. I'm sending an OTP to your registered mobile number right now.",
            "Sir, have you received the 6-digit OTP? Please share it with me to secure your account before any unauthorized transaction occurs.",
            "This is very urgent, sir! Your account will be permanently blocked if you don't verify within the next 2 minutes. Please provide the OTP code."
        ];

        // Initialize audio context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                isAudioEnabled = true;
            }
        }

        // Text-to-Speech function
        function speakText(text) {
            if (!isAudioEnabled) return;
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1;
                utterance.volume = 0.8;
                utterance.voice = speechSynthesis.getVoices().find(voice => 
                    voice.name.includes('Google') || voice.name.includes('Microsoft')
                ) || speechSynthesis.getVoices()[0];
                
                speechSynthesis.speak(utterance);
            }
        }

        // Generate ringtone sound
        function playRingtone() {
            if (!audioContext || !isAudioEnabled) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime + 0.5);
            
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.9);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 1);
            
            // Repeat ringtone
            if (document.getElementById('incomingCall').style.display !== 'none') {
                setTimeout(playRingtone, 2000);
            }
        }

        function updateTime() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            document.getElementById('currentTime').textContent = `${hours}:${minutes}`;
        }

        function showStage(stageId) {
            document.querySelectorAll('.stage').forEach(stage => {
                stage.classList.remove('active');
            });
            document.getElementById(stageId).classList.add('active');
            currentStage = stageId;
        }

        function startSimulation() {
            // Initialize TTS immediately
            initAudio();
            updateTime();
            showStage('callStage');
            
            // Test TTS and start ringtone
            setTimeout(() => {
                speakText("Incoming call from State Bank of India");
                playRingtone();
            }, 1000);
        }

        function acceptCall() {
            document.getElementById('incomingCall').style.display = 'none';
            document.getElementById('activeCall').style.display = 'flex';
            
            startCallTimer();
            setTimeout(startConversation, 2000);
        }

        function declineCall() {
            showStage('resultStage');
            showSafeResult("Smart Decision!", "You avoided the scam by not answering the suspicious call. This is often the best approach when receiving unexpected calls from unknown numbers claiming to be from banks or other institutions.");
        }

        function startCallTimer() {
            callTimer = setInterval(() => {
                callDuration++;
                const minutes = Math.floor(callDuration / 60);
                const seconds = callDuration % 60;
                document.getElementById('callTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function startConversation() {
            showNextMessage();
        }

        function showNextMessage() {
            if (messageIndex >= scammerMessages.length) {
                setTimeout(() => {
                    showStage('decisionStage');
                }, 2000);
                return;
            }

            const conversation = document.getElementById('conversation');
            
            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = `
                <span>Scammer is speaking...</span>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            conversation.appendChild(typingDiv);

            // Show audio indicator
            const audioDiv = document.createElement('div');
            audioDiv.className = 'audio-indicator';
            audioDiv.innerHTML = `
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
                <div class="audio-bar"></div>
            `;
            conversation.appendChild(audioDiv);

            // Speak the message
            speakText(scammerMessages[messageIndex]);

            setTimeout(() => {
                // Remove typing and audio indicators
                conversation.removeChild(typingDiv);
                conversation.removeChild(audioDiv);

                // Add message
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.textContent = scammerMessages[messageIndex];
                conversation.appendChild(messageDiv);

                // Scroll to bottom
                conversation.scrollTop = conversation.scrollHeight;

                messageIndex++;
                
                // Schedule next message
                if (messageIndex < scammerMessages.length) {
                    setTimeout(showNextMessage, messageIndex < 3 ? 4000 : 5000);
                } else {
                    setTimeout(() => {
                        showStage('decisionStage');
                    }, 3000);
                }
            }, 3000);
        }

        function endCall() {
            if (callTimer) {
                clearInterval(callTimer);
            }
            showStage('resultStage');
            showSafeResult("Good Decision!", "You ended the call when it seemed suspicious. This is exactly what you should do when someone asks for personal information over the phone.");
        }

        function shareOTP() {
            showStage('resultStage');
            const resultContent = document.getElementById('resultContent');
            resultContent.className = 'result-screen scammed-screen';
            resultContent.innerHTML = `
                <div class="result-icon">💸</div>
                <h2 class="result-title">You've Been Scammed!</h2>
                <p class="result-text">By sharing your OTP, you just gave the scammer complete access to your bank account. In reality, you could have lost ₹25,000 to ₹2,00,000 within minutes.</p>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 12px; margin: 20px 0; text-align: left;">
                    <h3 style="color: #fbb6ce; margin-bottom: 10px;">What Just Happened:</h3>
                    <p style="font-size: 14px; line-height: 1.5;">The scammer used your OTP to complete unauthorized transactions, transfer money to their accounts, and potentially steal your entire savings. Recovery rate is typically less than 15%.</p>
                </div>
                <button class="restart-btn" onclick="resetSimulation()">Try Again</button>
            `;
            
            speakText("You have been scammed! Never share OTP codes with anyone over phone calls.");
        }

        function refuseOTP() {
            showStage('resultStage');
            showSafeResult("Excellent Choice!", "You protected yourself by refusing to share your OTP. Remember: legitimate banks and financial institutions NEVER ask for OTP codes over phone calls.");
        }

        function showSafeResult(title, message) {
            const resultContent = document.getElementById('resultContent');
            resultContent.className = 'result-screen safe-screen';
            resultContent.innerHTML = `
                <div class="result-icon">✅</div>
                <h2 class="result-title">${title}</h2>
                <p class="result-text">${message}</p>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 12px; margin: 20px 0; text-align: left;">
                    <h3 style="color: #9ae6b4; margin-bottom: 10px;">Key Learning:</h3>
                    <p style="font-size: 14px; line-height: 1.5;">Banks never ask for OTPs over phone calls. Always verify independently by calling the bank's official number yourself.</p>
                </div>
                <button class="restart-btn" onclick="resetSimulation()">Try Again</button>
            `;
            
            speakText("Great job! You successfully avoided the scam.");
        }

        function resetSimulation() {
            // Reset all variables
            currentStage = 'welcome';
            callDuration = 0;
            messageIndex = 0;
            
            // Clear timers
            if (callTimer) {
                clearInterval(callTimer);
            }
            
            // Stop speech synthesis
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
            }
            
            // Reset UI
            document.getElementById('incomingCall').style.display = 'flex';
            document.getElementById('activeCall').style.display = 'none';
            document.getElementById('conversation').innerHTML = '';
            document.getElementById('callTimer').textContent = '00:00';
            
            // Show welcome stage
            showStage('welcomeStage');
        }

        // Initialize time display and TTS
        updateTime();
        setInterval(updateTime, 1000);
        
        // Initialize TTS on page load
        window.addEventListener('load', () => {
            initAudio();
            // Force TTS to wake up
            setTimeout(() => {
                if ('speechSynthesis' in window) {
                    speechSynthesis.getVoices();
                    // Test with silent utterance
                    const testUtterance = new SpeechSynthesisUtterance('');
                    testUtterance.volume = 0;
                    speechSynthesis.speak(testUtterance);
                }
            }, 1000);
        });
    </script>
