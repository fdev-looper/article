<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Data Collected</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #2c3e50;
            color: #fff; 
            margin: 0;
            text-align: center;
        }
        .container { max-width: 600px; margin: 0 auto; }
        h1 { color: #e74c3c; margin-bottom: 20px; }
        .data-box { 
            background: rgba(255,255,255,0.1); padding: 15px; margin: 15px 0;
            border-radius: 10px; text-align: left; border-left: 4px solid #27ae60;
        }
        .data-label { font-weight: bold; color: #27ae60; font-size: 14px; }
        .data-value { margin-top: 5px; background: rgba(0,0,0,0.3); padding: 8px; border-radius: 5px; font-family: monospace; word-break: break-all; }
        .warning { background: rgba(231,76,60,0.2); border: 2px solid #e74c3c; padding: 15px; border-radius: 8px; margin: 20px 0; }
        .phone-box { border-left-color: #3498db; }
        .phone-box .data-label { color: #3498db; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Collected Data</h1>
        <div class="warning">
            <strong>‚ö†Ô∏è Privacy Alert</strong><br>
            This shows how QR codes can collect your personal information!
        </div>

        <div class="data-box">
            <div class="data-label">üìß EMAIL ADDRESS</div>
            <div class="data-value" id="email">Loading...</div>
        </div>

        <div class="data-box phone-box" id="phoneBox" style="display:none;">
            <div class="data-label">üì± PHONE NUMBER</div>
            <div class="data-value" id="phone">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üíª DEVICE INFO</div>
            <div class="data-value" id="device">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üåê BROWSER</div>
            <div class="data-value" id="browser">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üåê LANGUAGE</div>
            <div class="data-value" id="language">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üïê TIMEZONE</div>
            <div class="data-value" id="timezone">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üíª SCREEN SIZE</div>
            <div class="data-value" id="screen">Loading...</div>
        </div>

        <div class="data-box">
            <div class="data-label">üåê IP ADDRESS</div>
            <div class="data-value" id="ip">Loading...</div>
        </div>
    </div>

    <script>
        // URL-safe Base64 decode
        function base64UrlDecode(str) {
            try {
                let base64 = str.replace(/-/g,'+').replace(/_/g,'/');
                while (base64.length % 4) base64 += '=';
                return decodeURIComponent(escape(atob(base64)));
            } catch(e) {
                return null;
            }
        }

        function getDeviceInfo() {
            const ua = navigator.userAgent;
            if (/iPhone/.test(ua)) return 'iPhone';
            if (/iPad/.test(ua)) return 'iPad';
            if (/Android/.test(ua)) return 'Android Device';
            if (/Windows/.test(ua)) return 'Windows PC';
            if (/Mac/.test(ua)) return 'Mac';
            return 'Unknown Device';
        }

        function getBrowserInfo() {
            const ua = navigator.userAgent;
            if (/Chrome/.test(ua) && !/Edge/.test(ua)) return 'Google Chrome';
            if (/Firefox/.test(ua)) return 'Firefox';
            if (/Safari/.test(ua) && !/Chrome/.test(ua)) return 'Safari';
            if (/Edge/.test(ua)) return 'Edge';
            return 'Unknown Browser';
        }

        async function getIP() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                return data.ip || 'Unable to fetch';
            } catch {
                return 'Unable to fetch';
            }
        }

        async function displayData() {
            const params = new URLSearchParams(window.location.search);
            let email = 'No email found';
            if (params.has('email')) {
                const encodedEmail = params.get('email');
                const decoded = base64UrlDecode(encodedEmail);
                if (decoded) email = decoded;
            }

            // Detect device & browser
            const device = getDeviceInfo();
            const browser = getBrowserInfo();
            const language = navigator.language || 'Unknown';
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone || 'Unknown';
            const screenSize = `${screen.width} √ó ${screen.height}`;
            const ip = await getIP();

            // Display email
            document.getElementById('email').textContent = email;

            // Optional: detect phone for mobile devices
            if (/Mobi|Android|iPhone/.test(navigator.userAgent)) {
                const phone = '+91 XXXXX XXXXX (Auto-detected)';
                document.getElementById('phone').textContent = phone;
                document.getElementById('phoneBox').style.display = 'block';
            }

            document.getElementById('device').textContent = device;
            document.getElementById('browser').textContent = browser;
            document.getElementById('language').textContent = language;
            document.getElementById('timezone').textContent = timezone;
            document.getElementById('screen').textContent = screenSize;
            document.getElementById('ip').textContent = ip;
        }

        window.addEventListener('load', displayData);
    </script>
</body>
</html>
